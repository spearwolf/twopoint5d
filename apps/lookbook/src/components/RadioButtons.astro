---
interface Props {
  name: string;
  buttons: Array<{
    label: string;
    value: string;
    isActive?: boolean;
  }>;
}

const {name, buttons} = Astro.props;
---

<div class="radio-buttons">
  {
    buttons.map((button) => (
      <button class="btn" class:list={[{'is-active': button.isActive}]} data-radio-buttons-group={name} data-value={button.value}>
        {button.label}
      </button>
    ))
  }
</div>

<script>
  import {queryRadioButtons} from './RadioButtonsApi';

  const buttons = document.querySelectorAll(`button[data-radio-buttons-group]`);

  buttons.forEach((button) => {
    const groupName = button.getAttribute('data-radio-buttons-group');
    const stateValue = button.getAttribute('data-value');

    const isActive = button.classList.contains('is-active');

    const state = queryRadioButtons(groupName);

    if (isActive) {
      state.set(stateValue);
    }

    button.addEventListener('click', () => {
      button.parentElement.querySelectorAll(`button[data-radio-buttons-group="${groupName}"]`).forEach((btn) => {
        btn.classList.remove('is-active');
      });
      button.classList.add('is-active');
      state.set(stateValue);
    });
  });
</script>

<style>
  .radio-buttons {
    display: flex;
    justify-content: center;
    pointer-events: none;
  }

  .btn {
    font-family: sans-serif;
    font-size: 1rem;
    font-weight: bold;

    line-height: 1;

    margin: 0.1em 0.2em;
    padding: 0.5em 1em;

    border-radius: 1em;
    border: 0;

    cursor: pointer;
    user-select: none;
    pointer-events: auto;

    transition: 0.2s;

    position: relative;
    z-index: 0;

    background: #202028;
    color: #eee;

    box-shadow:
      inset 0 0 0.2em #010,
      0 0 0.75em rgba(245, 240, 255, 0.25);
  }

  .btn:hover {
    background: #282830;
    text-shadow:
      0 0 0.5em #fff,
      -0.5em 0 2em #f09,
      0.5em 0 2em #09f;
  }

  .btn.is-active {
    color: #fff;

    box-shadow:
      inset 0 0 1.5em #cc9,
      inset 0.5em 0 1.5em #f06,
      inset -0.5em 0 1.5em #06f,
      inset 0.5em 0 3em #f06,
      inset -0.5em 0 5em #06f,
      0 0 0.5em #fff,
      -0.5em 0 1.5em #f06,
      0.5em 0 1.5em #06f;

    z-index: 1;
  }

  .btn:first-child {
    margin-right: 0;
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
  }

  .btn:not(:last-child):not(:first-child) {
    margin-left: 0;
    margin-right: 0;
    border-radius: 0;
  }

  .btn:last-child {
    margin-left: 0;
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }
</style>
